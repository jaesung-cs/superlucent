#version 450

layout (local_size_x = 256) in;

#include "particle/particle.h"
#include "particle/simulation_params.h"
#include "particle/collision_pairs.h"
#include "particle/solver.h"

void main() 
{
	const uint index = gl_GlobalInvocationID.x;
	if (index >= Rows() + Cols())
    return;

  // lambda
  if (index < Rows())
  {
    solver.matrix[LambdaIndex(index)] += solver.matrix[DeltaLambdaIndex(index)];
  }

  // x
  else
  {
    uint row = index - Rows();
    solver.matrix[XIndex(row)] += solver.matrix[DeltaXIndex(row)];
  }
}
